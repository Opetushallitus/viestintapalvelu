<div class="row" ng-if="isEmailState()">
    <div>
        <h2 class="align-with-form">{{'email.header.viesti' | i18n}}</h2>
    </div>
    <div class="span8">
        <form novalidate="novalidate" class="form-horizontal">
            <recipient-list recipients="recipients" form="true" limit="30"></recipient-list>
            <div class="control-group">
                <label class="control-label">{{'email.label.sender' | i18n}}</label>
                <div class="controls">
                    <input type="text" size="40" ng-model="email.sender"/>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">{{'email.label.from' | i18n}}</label>
                <div class="controls">
                    <span>&lt;{{email.from}}&gt;</span>
                    <input type="hidden" ng-model="email.organizationOid"/>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">{{'email.label.replyto' | i18n}}</label>
                <div class="controls">
                    <input type="text" size="40" ng-model="email.replyTo"/>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label required">{{'email.label.subject' | i18n}}</label>
                <div class="controls">
                    <input type="text" size="40" ng-model="email.subject"/>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label required">{{'email.label.viesti' | i18n}}</label>
                <div class="controls">
                     <textarea ui-tinymce="tinymceOptions" ng-model="email.body"></textarea>
                </div>
            </div>
            <input type="hidden" ng-model="email.templateName"/>
            <div class="control-group attachment-group">
                <label class="control-label">{{'email.label.attachments' | i18n}}</label>
                <div class="controls">
                    <span class="bold" ng-show="!email.attachInfo.length">{{'email.liitteet.ei' | i18n}}</span>
                    <ul class="filelist">
                        <li ng-repeat="attachment in email.attachInfo">{{attachment.fileName | limitSizeWithMiddleEllipsis : 15}} ({{attachment.fileSize | bytesToSize}})
                            <a ng-click="remove($index)"><i class="icon-remove"></i>Poista</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div ng-show="percentage" class="control-group">
                <div class="controls">
                    <div class="span3 progress">
                        <div class="bar" ng-style="percentage2"></div>
                    </div>
                </div>
            </div>
            <div class="control-group">
                <div class="controls">
                    <span class="btn btn-small fileinput-button">
                        <span>{{'email.button.attachment.choose' | i18n}}</span>
                        <input  id="attachment-input" type="file" name="file" data-url="/ryhmasahkoposti-service/email/attachment" multiple upload>
                    </span>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label"></label>
                <div class="controls"> 
                    <button ng-click="cancelEmail()" class="inline-operation btn btn-small">
                        {{'email.button.peruuta' | i18n}}
                    </button>
                    <button ng-click="saveDraft()" class="inline-operation btn btn-small">
                        {{'email.button.tallenna' | i18n}}
                    </button>
                    <button ng-click="previewEmail()" class="inline-operation btn-primary btn-small">
                        {{'email.button.preview' | i18n}}
                    </button>
                </div>
            </div>
        </form>
    </div>
    <div class="span4">
        <div class="notification">
            <h5>{{'email.notification.choose' | i18n}}</h5>
            <p>{{'email.notification.description' | i18n }}</p>
            <ul class="linklist">
                <!-- <li><a ui-sref=".savedContent.templates" ui-sref-active="active">Valmiit viestipohjat</a></li> -->
                <li><a ui-sref=".savedContent.sentEmails" ui-sref-active="active">{{'email.sentEmails' | i18n}} (<span ng-bind="counts.emails"></span>)</a></li>
                <li><a ui-sref=".savedContent.drafts" ui-sref-active="active">{{'email.drafts' | i18n}} (<span ng-bind="counts.drafts"></span>)</a></li>
            </ul>
        </div>
    </div>
</div>
<div ng-if="!isEmailState()">
    <div class="span8" ui-view></div>
</div>
